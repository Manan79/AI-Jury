{% extends "admin/base_site.html" %}

{% block content %}
<div class="session-analytics">
    <h1>Session Analytics: {{ session.title }}</h1>
    
    <div class="session-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <strong>Total Messages</strong><br>
            {{ total_messages }}
        </div>
        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <strong>User Messages</strong><br>
            {{ user_messages }}
        </div>
        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <strong>AI Responses</strong><br>
            {{ ai_messages }}
        </div>
        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <strong>Avg Thinking Time</strong><br>
            {{ avg_thinking_time }}s
        </div>
    </div>

    <div class="message-list" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h2>Message History</h2>
        {% for message in messages %}
        <div style="margin: 15px 0; padding: 15px; border-left: 4px solid {% if message.is_user %}#10b981{% else %}#3b82f6{% endif %}; background: #f9fafb;">
            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 8px;">
                <strong>{% if message.is_user %}ğŸ‘¤ User{% else %}ğŸ¤– AI{% endif %}</strong>
                <small style="color: #6b7280;">{{ message.timestamp|date:"M d, Y H:i:s" }}</small>
            </div>
            <div style="white-space: pre-wrap;">{{ message.content }}</div>
            {% if not message.is_user and message.thinking_time %}
            <small style="color: #6b7280;">Thinking time: {{ message.thinking_time }}s</small>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}